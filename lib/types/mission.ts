// ê¸°ì¡´ Mission ì¸í„°í˜ì´ìŠ¤ í™•ì¥
export interface Mission {
  id: string
  userId?: string           // ë¯¸ì…˜ì„ ì†Œìœ í•œ ì‚¬ìš©ì ID (Supabase ì‚¬ìš© ì‹œ)
  title: string
  description?: string
  reward: number
  isCompleted: boolean
  completedAt?: string
  isTransferred?: boolean
  category?: string
  missionType?: string
  recurringPattern?: RecurringPattern // ë°˜ë³µ íŒ¨í„´
  // ìƒˆë¡œ ì¶”ê°€ë˜ëŠ” í•„ë“œë“¤
  date?: string             // YYYY-MM-DD í˜•ì‹, ê¸°ë³¸ê°’: ì˜¤ëŠ˜ ë‚ ì§œ
  templateId?: string | null // í…œí”Œë¦¿ ID, nullì´ë©´ ì¼íšŒì„± ë¯¸ì…˜
  // ğŸ†• ì œì•ˆ ê´€ë ¨ í•„ë“œë“¤
  isFromProposal?: boolean  // ìë…€ ì œì•ˆìœ¼ë¡œë¶€í„° ìƒì„±ëœ ë¯¸ì…˜ì¸ì§€
  proposalId?: string       // ì›ë³¸ ì œì•ˆì˜ ID (ì¶”ì ìš©)
}

// ë°˜ë³µ íŒ¨í„´ íƒ€ì… ì •ì˜
export type RecurringPattern = 
  | 'daily'        // ë§¤ì¼
  | 'weekdays'     // í‰ì¼ë§Œ (ì›”-ê¸ˆ)
  | 'weekends'     // ì£¼ë§ë§Œ (í† -ì¼)
  | 'weekly_sun'   // ë§¤ì£¼ ì¼ìš”ì¼
  | 'weekly_mon'   // ë§¤ì£¼ ì›”ìš”ì¼
  | 'weekly_tue'   // ë§¤ì£¼ í™”ìš”ì¼
  | 'weekly_wed'   // ë§¤ì£¼ ìˆ˜ìš”ì¼
  | 'weekly_thu'   // ë§¤ì£¼ ëª©ìš”ì¼
  | 'weekly_fri'   // ë§¤ì£¼ ê¸ˆìš”ì¼
  | 'weekly_sat'   // ë§¤ì£¼ í† ìš”ì¼

// ë¯¸ì…˜ í…œí”Œë¦¿ ì¸í„°í˜ì´ìŠ¤
export interface MissionTemplate {
  id: string
  userId: string                      // í…œí”Œë¦¿ ìƒì„±ì ID (ë³´í†µ ë¶€ëª¨)
  title: string
  description: string
  reward: number
  category: string
  missionType: 'daily' | 'event'
  recurringPattern?: RecurringPattern  // ë°˜ë³µ íŒ¨í„´ (daily íƒ€ì…ì¼ ë•Œë§Œ ì‚¬ìš©)
  isActive: boolean
  targetChildId?: string | null       // íŠ¹ì • ìë…€ ëŒ€ìƒ í…œí”Œë¦¿ (nullì´ë©´ ê³µìš© í…œí”Œë¦¿)
  createdAt: string
  updatedAt: string
}

// ë¯¸ì…˜ ì¸ìŠ¤í„´ìŠ¤ (ë‚ ì§œë³„ ì‹¤ì œ ë¯¸ì…˜)
export interface MissionInstance {
  id: string
  userId?: string           // ë¯¸ì…˜ì„ ì†Œìœ í•œ ì‚¬ìš©ì ID (Supabase ì‚¬ìš© ì‹œ)
  templateId: string | null  // nullì´ë©´ ì¼íšŒì„± ë¯¸ì…˜
  date: string              // YYYY-MM-DD í˜•ì‹
  title: string
  description: string
  reward: number
  category: string
  missionType: 'daily' | 'event'
  recurringPattern?: RecurringPattern // ë°˜ë³µ íŒ¨í„´
  isCompleted: boolean
  completedAt?: string
  isTransferred?: boolean
}

// ë‚ ì§œë³„ ìš”ì•½ ì •ë³´
export interface DateSummary {
  date: string              // YYYY-MM-DD
  totalMissions: number
  completedMissions: number
  totalReward: number
  earnedReward: number
  lastUpdated: string
}

// ì‚¬ìš©ì ì„¤ì •
export interface UserSettings {
  id: string
  autoGenerateDays: number  // ë¯¸ë˜ ë©°ì¹ ê¹Œì§€ ë°ì¼ë¦¬ ë¯¸ì…˜ ìƒì„±í• ì§€
  dataRetentionDays: number // ê³¼ê±° ë°ì´í„° ë³´ê´€ ì¼ìˆ˜
  notificationEnabled: boolean
  backupEnabled: boolean
  createdAt: string
  updatedAt: string
}

// ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
export const DB_CONFIG = {
  NAME: 'KidsAllowanceDB_v2',
  VERSION: 1,
  STORES: {
    MISSION_TEMPLATES: 'missionTemplates',
    MISSION_INSTANCES: 'missionInstances', 
    DATE_SUMMARIES: 'dateSummaries',
    USER_SETTINGS: 'userSettings'
  },
  INDEXES: {
    INSTANCES_BY_DATE: 'by_date',
    INSTANCES_BY_TEMPLATE: 'by_template',
    SUMMARIES_BY_DATE: 'by_date'
  }
}